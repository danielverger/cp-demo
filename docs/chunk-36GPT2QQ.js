import{c as ee,d as te,e as ie,f as re,g as oe,h as ne,i as ae,j as le,k as se,l as L}from"./chunk-TA3RR46O.js";import{D as me,E as pe,F as ce,h as T,i as E,j as P,k as A,n as k,q as J,s as K,t as Q,v as U,w as W,x as X,y as Y,z as Z}from"./chunk-KHNP4NKL.js";import"./chunk-XSSXK7EZ.js";import"./chunk-CV2ZWZQE.js";import{A as j,Ac as v,Fc as H,L as $,Oa as C,Qa as m,R as c,Ta as q,W as x,Wa as n,Xa as l,Ya as d,ab as M,bb as g,cb as p,da as f,ea as _,ec as O,fc as R,ic as B,j as N,kb as D,lb as h,nb as I,pc as z,sb as G,tb as S,u,ub as F,wc as V,xa as s,ya as b}from"./chunk-CMRFUSMR.js";import"./chunk-TMC7WMLO.js";var w=(()=>{let i=class i{constructor(){this.http=c(z)}getCategories(){return this.http.get("categories").pipe(u(this.handleError))}getCategory(e){return this.http.get(`categories/${e}`).pipe(u(this.handleError))}addCategory(e){return this.http.post("categories",e).pipe(u(this.handleError))}modifyCategory(e){return this.http.put(`categories/${e.id}`,e).pipe(u(this.handleError))}deleteCategory(e){return this.http.delete(`categories/${e}`).pipe(u(this.handleError))}handleError(){return N(()=>"Something bad happened; please try again later.")}};i.\u0275fac=function(r){return new(r||i)},i.\u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"});let t=i;return t})();var ge=(()=>{let i=class i{constructor(e,r,o){this.ref=e,this.config=r,this.fb=o,this.categoryService=c(w),this.messageService=c(v),this.loading=!1,this.categoryForm=this.fb.group({name:["",[k.required]],description:["",k.required],image:["",k.required],id:[0]})}ngOnInit(){this.config.data.categoryId!=null&&(this.loading=!0,this.categoryService.getCategory(this.config.data.categoryId).subscribe({next:e=>{this.categoryForm.patchValue(e)},error:e=>{this.loading=!1},complete:()=>{this.loading=!1}}))}closeDialog(){this.ref.close(!1)}saveCategory(){let e=this.config.data.categoryId===null,r=this.categoryForm.getRawValue();(e?this.categoryService.addCategory(r):this.categoryService.modifyCategory(r)).subscribe({next:y=>{this.messageService.add({severity:"success",summary:"Successful",detail:`Categoria ${e?"a\xF1adida":"modificada"}`,life:3e3}),this.ref.close(!0)},error:y=>{}})}};i.\u0275fac=function(r){return new(r||i)(b(se),b(le),b(U))},i.\u0275cmp=x({type:i,selectors:[["app-category-edit"]],standalone:!0,features:[S],decls:9,vars:17,consts:[[1,"flex","flex-column"],[3,"formGroup"],[1,"flex","grid","m-0","align-items-center"],["formName","name",1,"col-4",3,"labelText","labelFor","required","group","loading"],["formName","description",1,"col-4",3,"labelText","labelFor","required","group","loading"],["formName","image",1,"col-4",3,"labelText","labelFor","required","group","loading"],[1,"flex","justify-content-end","gap-2"],["label","Cancelar","severity","secondary",3,"onClick"],["label","Guardar",3,"onClick","disabled"]],template:function(r,o){r&1&&(n(0,"div",0)(1,"form",1)(2,"div",2),d(3,"app-form-field-molecule",3)(4,"app-form-field-molecule",4)(5,"app-form-field-molecule",5),l(),n(6,"div",6)(7,"p-button",7),g("onClick",function(){return o.closeDialog()}),l(),n(8,"p-button",8),g("onClick",function(){return o.saveCategory()}),l()()()()),r&2&&(s(),m("formGroup",o.categoryForm),s(2),m("labelText","Nombre")("labelFor","nombre")("required",!0)("group",o.categoryForm)("loading",o.loading),s(),m("labelText","Descripci\xF3n")("labelFor","descripcion")("required",!0)("group",o.categoryForm)("loading",o.loading),s(),m("labelText","Imagen")("labelFor","imagen")("required",!0)("group",o.categoryForm)("loading",o.loading),s(3),m("disabled",o.categoryForm.invalid))},dependencies:[ce,E,T,X,K,J,Q]});let t=i;return t})();var fe=()=>["name","description","image"],_e=()=>({"min-width":"50rem"}),Ce=()=>({width:"450px"});function he(t,i){if(t&1){let a=M();n(0,"div",10)(1,"p-button",11),g("onClick",function(){f(a);let r=p();return _(r.editCategory(null))}),l(),n(2,"div",12)(3,"span",13),d(4,"i",14),n(5,"input",15),g("input",function(r){f(a);let o=p(),y=D(10);return _(o.onGlobalFilter(y,r))}),l()(),n(6,"p-button",16),g("onClick",function(){f(a);let r=p(),o=D(10);return _(r.exportToExcel(o))}),l()()()}}function ye(t,i){if(t&1&&(n(0,"th",18),h(1),l()),t&2){let a=i.$implicit;s(),I(" ",a.header," ")}}function ve(t,i){if(t&1&&(n(0,"tr"),C(1,ye,2,1,"th",17),d(2,"th",18),l()),t&2){let a=i.$implicit;s(),m("ngForOf",a)}}function xe(t,i){if(t&1&&(n(0,"td"),h(1),l()),t&2){let a=i.$implicit,e=p(2).$implicit;s(),I(" ",e[a.field]," ")}}function be(t,i){if(t&1){let a=M();n(0,"tr"),C(1,xe,2,1,"td",20),n(2,"td")(3,"div",21)(4,"p-button",22),g("onClick",function(){f(a);let r=p().$implicit,o=p();return _(o.editCategory(r.id))}),n(5,"span",23),h(6,"edit"),l()(),n(7,"p-button",24),g("onClick",function(){f(a);let r=p().$implicit,o=p();return _(o.deleteCategory(r))}),n(8,"span",23),h(9,"delete"),l()()()()()}if(t&2){let a=p().columns;s(),m("ngForOf",a),s(3),m("rounded",!0),s(3),m("rounded",!0)}}function Se(t,i){t&1&&(n(0,"td"),d(1,"p-skeleton",26),l())}function Fe(t,i){if(t&1&&(n(0,"tr"),C(1,Se,2,0,"td",20),n(2,"td")(3,"div",21),d(4,"p-skeleton",25)(5,"p-skeleton",25),l()()()),t&2){let a=p().columns;s(),m("ngForOf",a)}}function Te(t,i){if(t&1&&C(0,be,10,3,"tr",19)(1,Fe,6,1,"tr",19),t&2){let a=p();m("ngIf",!a.loading),s(),m("ngIf",a.loading)}}var dt=(()=>{let i=class i{constructor(){this.confirmationService=c(V),this.messageService=c(v),this.dialogService=c(L),this.categoryService=c(w),this.loading=!1,this.cols=[{field:"name",header:"Nombre"},{field:"description",header:"Descripci\xF3n"},{field:"image",header:"Imagen"},{field:"",header:""}],this.categories=[...Array(10)].map(e=>({id:0,name:"",description:"",image:""}))}ngOnInit(){this.loadCategories()}loadCategories(){this.loading=!0,this.categoryService.getCategories().subscribe({next:e=>{this.categories=e},error:e=>{this.loading=!1},complete:()=>{this.loading=!1}})}onGlobalFilter(e,r){e.filterGlobal(r.target.value,"contains")}exportToExcel(e){e.exportCSV()}deleteCategory(e){this.confirmationService.confirm({message:"Seguro que quiere eliminar la categoria "+e.name+"?",header:"Confirmar",icon:"pi pi-exclamation-triangle",accept:()=>{this.categoryService.deleteCategory(e.id).pipe(j(()=>this.loadCategories())).subscribe(),this.messageService.add({severity:"success",summary:"Successful",detail:"Categoria eliminada",life:3e3})}})}editCategory(e){this.dialogService.open(ge,{dismissableMask:!1,header:e===null?"Nueva Categoria":"Modificar Categoria",data:{categoryId:e},width:"600px"}).onClose.subscribe(o=>{o&&this.loadCategories()})}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=x({type:i,selectors:[["app-categories-list"]],standalone:!0,features:[G([v,V,L]),S],decls:15,vars:14,consts:[["dt",""],[1,"surface-ground","justify-content-center","flex","min-h-screen","min-w-screen","overflow-hidden","pt-8"],[1,"flex","flex-column"],[1,"text-center","mb-5"],[1,"text-900","text-2xl","font-medium","mb-3"],[1,"text-600","font-medium"],["responsiveLayout","stack",3,"rows","paginator","globalFilterFields","columns","value","breakpoint","exportHeader","tableStyle","styleClass"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex","align-items-center","justify-content-between"],["pRipple","","severity","success","label","Nuevo","icon","pi pi-plus",1,"mr-2",3,"onClick"],[1,"flex","gap-2"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["pRipple","","icon","pi pi-external-link","label","Export",3,"onClick"],["scope","column",4,"ngFor","ngForOf"],["scope","column"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"flex","gap-2","justify-content-end"],["pRipple","","icon","pi","severity","secondary","size","small",3,"onClick","rounded"],[1,"material-icons"],["pRipple","","icon","pi","severity","danger","size","small",3,"onClick","rounded"],["shape","circle","size","2.5rem"],["height","2rem"]],template:function(r,o){r&1&&(n(0,"div",1)(1,"div",2),d(2,"p-toast"),n(3,"p-card")(4,"div",3)(5,"div",4),h(6,"Categorias"),l(),d(7,"span",5),l(),n(8,"div")(9,"p-table",6,0),C(11,he,7,0,"ng-template",7)(12,ve,3,1,"ng-template",8)(13,Te,2,2,"ng-template",9),l()()()(),d(14,"p-confirmDialog"),l()),r&2&&(s(9),m("rows",10)("paginator",!0)("globalFilterFields",F(11,fe))("columns",o.cols)("value",o.categories)("breakpoint","960px")("exportHeader","customExportHeader")("tableStyle",F(12,_e))("styleClass","p-datatable-sm"),s(5),q(F(13,Ce)))},dependencies:[A,P,H,te,ee,E,T,Z,Y,B,O,R,oe,re,ie,W,ae,ne,pe,me]});let t=i;return t})();export{dt as CategoriesListComponent};
